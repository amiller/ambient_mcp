services:
  mcp-app:
    build:
      context: .
      dockerfile_inline: |
        FROM python:3.10-slim
        WORKDIR /app
        RUN apt-get update && apt-get install -y && rm -rf /var/lib/apt/lists/*
        COPY requirements.txt .
        RUN pip install --no-cache-dir -r requirements.txt
        COPY oauth_mcp_proxy.py .
        COPY ambient_mcp_server.py .
        COPY start_services.py .
        RUN mkdir -p mcp_data
        EXPOSE 9100
        CMD ["python", "start_services.py"]
    ports:
      - "9100:9100"
    volumes:
      - mcp_data:/app/mcp_data
    restart: unless-stopped

volumes:
  mcp_data: